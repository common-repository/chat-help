let wHelp=document.querySelectorAll(".wHelp"),wHelpMulti=document.querySelectorAll(".wHelp-multi"),wHelpBubble=document.querySelectorAll(".wHelp-bubble"),currentTime=document.querySelector(".current-time"),wHelpUserAvailability=document.querySelectorAll(".wHelpUserAvailability"),wHelpMultiPopupContent=document.querySelector(".wHelp-multi__popup--content"),wHelpCheckboxDiv=document.querySelectorAll(".wHelp--checkbox"),wHelpCheckbox=document.querySelectorAll(".wHelp__checkbox"),wHelpCheckButton=document.querySelectorAll(".wHelp__send-message"),wHelpPopupContent=document.querySelectorAll(".wHelp__popup--content"),wHelpButtons=document.querySelectorAll(".wHelpButtons"),chatAvailability=document.querySelector(".chat-availability"),{autoShowPopup,autoOpenPopupTimeout}=whatshelp_frontend_script;if(currentTime){let e=new Date;currentTime.innerText=`${e.getHours()}:${e.getMinutes()}:`+e.getSeconds()}let toggleChatBtn=()=>{[...wHelp,...wHelpMulti].forEach(e=>e.classList.toggle("wHelp-show"))},initCheckboxState=(wHelpBubble.forEach(e=>e.addEventListener("click",toggleChatBtn)),()=>{"true"===localStorage.getItem("wHelpCheckboxValue")&&(wHelpCheckButton.forEach(e=>e.classList.remove("condition__checked")),wHelpCheckboxDiv.forEach(e=>e.style.display="none"))});function isAvailable(e,t){let a=!1,l=!1;for(var i in e){var o;e.hasOwnProperty(i)&&getDayOfWeek(i)===t.day()&&([i,o]=e[i].split("-").map(e=>moment(e,"HH:mm")),t.isBetween(i,o)&&(a=!0),t.isBefore(i))&&(l=!0)}return{isAvailable:a,almostAvailable:l}}wHelpCheckbox.forEach(e=>{e.addEventListener("change",function(){this.checked&&(localStorage.setItem("wHelpCheckboxValue",!0),initCheckboxState())})}),initCheckboxState();let getDayOfWeek=e=>["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].indexOf(e.toLowerCase()),handleUserAvailability=()=>{var e="true"===wHelpMultiPopupContent?.getAttribute("data-search"),t=document.querySelector(".wHelp-multi")?.classList.contains("wHelp-grid");wHelpUserAvailability.length&&(e&&wHelpMultiPopupContent.classList.add("wHelp-search"),wHelpUserAvailability.length>(t?4:3)&&wHelpMultiPopupContent.classList.add("wHelp-scroll"),wHelpUserAvailability.forEach(e=>{var t=JSON.parse(e.getAttribute("data-userAvailability")),a=e.getAttribute("data-timezone");isAvailable(t,a?moment().tz(a):moment()).isAvailable||null==t?(e.classList.add("avatar-active"),e.classList.remove("avatar-inactive")):(e.classList.add("avatar-inactive"),e.classList.remove("avatar-active"),e.setAttribute("disabled",!0))}))};function searchUser(){let a=document.getElementById("search-input").value.toUpperCase();var e=document.getElementById("multi-user").getElementsByClassName("user");Array.from(e).forEach(e=>{var t=e.querySelector(".user__info--name").textContent.toUpperCase();e.style.display=t.includes(a)?"":"none"})}handleUserAvailability();let updateButtonAvailability=()=>{wHelpButtons.forEach(e=>{var t=JSON.parse(e.getAttribute("data-btnavailablety")),a=e.getAttribute("data-timezone");isAvailable(t,a?moment().tz(a):moment()).isAvailable?(e.classList.add("avatar-active"),e.classList.remove("avatar-inactive")):(e.classList.add("avatar-inactive"),e.classList.remove("avatar-active"))})};if(updateButtonAvailability(),chatAvailability){let e=JSON.parse(chatAvailability.getAttribute("data-availability")),t=moment(),a=isAvailable(e,t);a.isAvailable?(chatAvailability.classList.add("avatar-active"),chatAvailability.classList.remove("avatar-inactive")):(chatAvailability.classList.add("avatar-inactive"),chatAvailability.classList.remove("avatar-active"))}!function(l){wHelpPopupContent.forEach(a=>{l(a).submit(function(e){e.preventDefault(),wHelpCheckButton.forEach(e=>{if(!e.classList.contains("condition__checked")){e=JSON.parse(chatAvailability?.getAttribute("data-availability"));if(e)if(isAvailable(e,moment()).isAvailable){let t=l(this);l.post(frontend_scripts.ajaxurl,{action:"handle_form_submission",nonce:frontend_scripts.nonce,name:t.find("#wHelp-name").val(),message:t.find("#wHelp-message").val(),template:a.getAttribute("data-template"),agent:a.getAttribute("data-number")},e=>{e.success?(window.open(e.data.whatsAppURL,"_blank"),t[0].reset()):alert("Error processing request.")}).fail(()=>alert("Unexpected error occurred."))}}})})})}(jQuery);let authShowPopup=()=>{autoShowPopup&&toggleChatBtn()};0<autoOpenPopupTimeout?setTimeout(authShowPopup,1e3*autoOpenPopupTimeout):authShowPopup();